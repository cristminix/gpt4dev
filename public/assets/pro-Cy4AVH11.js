import"./modulepreload-polyfill-B5Qt9EMX.js";import{Client as r,Puter as v,Together as y,HuggingFace as M,DeepInfra as E}from"https://g4f.dev/dist/js/client.js";import{marked as T}from"https://cdn.jsdelivr.net/npm/marked/lib/marked.esm.js";const s=document.getElementById("chat"),H=document.getElementById("form"),m=document.getElementById("input"),g=document.getElementById("provider"),h=document.getElementById("apiKey"),l=document.getElementById("modelSelect");let o=null,d=[],L="";async function p(){const a=g.value,n=h.value.trim(),e=n?{apiKey:n}:{};let t=r;switch(a){case"pollinations":t=r,e.defaultModel="deepseek";break;case"deepinfra":t=E;break;case"huggingface":t=M;break;case"together":t=y;break;case"puter":t=v;break;case"custom":t=r,e.baseUrl="http://localhost:8080/v1";break}o=new t(e),!o.apiKey&&o.getApiKey&&(o.apiKey=await o.getApiKey()),await b()}async function b(){l.innerHTML="<option disabled selected>Loading...</option>";try{const a=await o.models.list();l.innerHTML="",a.forEach(n=>{const e=document.createElement("option");e.value=n.id,e.textContent=n.id,n.id===o.defaultModel&&(e.selected=!0),l.appendChild(e)})}catch(a){console.error("Model load failed:",a),l.innerHTML=`<option value="${o.defaultModel}">${o.defaultModel}</option>`}}g.addEventListener("change",p);h.addEventListener("change",p);H.addEventListener("submit",async a=>{a.preventDefault();const n=m.value.trim();if(!n)return;const e=l.value||L;k("user",n),d.push({role:"user",content:n}),m.value="";const t=document.createElement("div");t.className="message assistant",t.innerHTML="<em>Typing...</em>",s.appendChild(t),s.scrollTop=s.scrollHeight;try{const c=await o.chat.completions.create({model:e,messages:d,stream:!0});let i="";for await(const u of c){const f=u.choices[0]?.delta?.content||u.choices[0]?.delta?.reasoning_content||"";i+=f,t.innerHTML=T.parse(i),s.scrollTop=s.scrollHeight}d.push({role:"assistant",content:i})}catch(c){t.innerHTML="<strong>Error:</strong> "+c.message}});function k(a,n){const e=document.createElement("div");e.className="message "+a,e.innerHTML=`<div class="user">${n}</div>`,s.appendChild(e),s.scrollTop=s.scrollHeight}await p();
